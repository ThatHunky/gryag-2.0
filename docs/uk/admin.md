# Посібник адміністратора

Цей посібник охоплює адмін-команди, конфігурацію контролю доступу та керування користувачами для Гряг 2.0.

## Налаштування адміністратора

### Встановлення адмінів

Адміністратори налаштовуються через змінну оточення `ADMIN_IDS`:

```env
ADMIN_IDS=12345678,87654321,11111111
```

**Отримання вашого User ID:**

1. Надішліть повідомлення [@userinfobot](https://t.me/userinfobot) в Telegram
2. Бот відповість з вашим user ID
3. Додайте ваш user ID до `ADMIN_IDS` в `.env`
4. Перезапустіть бота

**Примітка:** Адмін-команди працюють тільки в приватних чатах з ботом.

## Адмін-команди

Всі адмін-команди повинні бути надіслані в приватному чаті з ботом.

### `/status`

Відображає статус бота та конфігурацію.

**Використання:**
```
/status
```

**Вивід:**
- Час роботи бота
- Режим доступу
- Модель LLM
- Прапорці функцій (reasoning, structured output, тощо)
- Налаштування обмеження частоти
- Кількість адмінів
- Кількість чатів/користувачів у білому/чорному списку

### `/config`

Відображає поточну конфігурацію LLM та контексту.

**Використання:**
```
/config
```

**Вивід:**
- Базова URL LLM
- Основна модель
- Модель зору
- Модель сумаризації
- Налаштування таймаутів та повторних спроб
- Ліміти токенів
- Налаштування контексту

### `/ban`

Постійно заблокувати користувача від використання бота.

**Використання:**
```
/ban <user_id> [причина]
```

**Параметри:**
- `user_id` (обов'язково): Telegram user ID для блокування
- `причина` (опціонально): Причина блокування

**Приклад:**
```
/ban 12345678 Спам та переслідування
```

**Ефекти:**
- Користувач не може взаємодіяти з ботом
- Бан постійний (без закінчення)
- Зберігається в базі даних
- Може бути видалений через `/unban`

### `/unban`

Зняти бан користувача.

**Використання:**
```
/unban <user_id>
```

**Параметри:**
- `user_id` (обов'язково): Telegram user ID для розблокування

**Приклад:**
```
/unban 12345678
```

### `/restrict`

Тимчасово обмежити користувача.

**Використання:**
```
/restrict <user_id> <години> [причина]
```

**Параметри:**
- `user_id` (обов'язково): Telegram user ID для обмеження
- `години` (обов'язково): Кількість годин обмеження
- `причина` (опціонально): Причина обмеження

**Приклад:**
```
/restrict 12345678 24 Надмірні запити
```

### `/whitelist`

Керувати білим списком чатів (коли `ACCESS_MODE=whitelist`).

**Використання:**
```
/whitelist add <chat_id>
/whitelist remove <chat_id>
```

**Параметри:**
- `add|remove` (обов'язково): Дія для виконання
- `chat_id` (обов'язково): Telegram chat ID

**Отримання Chat ID:**
- Для груп: Додайте [@userinfobot](https://t.me/userinfobot) до групи
- Для приватних чатів: Ваш user ID є chat ID

### `/blacklist`

Керувати чорним списком користувачів.

**Використання:**
```
/blacklist add <user_id>
/blacklist remove <user_id>
```

### `/reload_prompt`

Перевірити, що файл системного промпту доступний.

## Контроль доступу

### Режими доступу

Бот підтримує три режими доступу:

#### 1. Global (`ACCESS_MODE=global`)

**Режим за замовчуванням.** Бот відповідає в усіх чатах.

#### 2. Private (`ACCESS_MODE=private`)

Бот відповідає тільки в приватних чатах.

#### 3. Whitelist (`ACCESS_MODE=whitelist`)

Бот відповідає тільки в чатах з білого списку та приватних чатах.

## Обмеження частоти

### Конфігурація

```env
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PROMPTS=30
RATE_LIMIT_WINDOW_HOURS=1
```

**Примітка:** Адміністратори обходять обмеження частоти автоматично.

## Пов'язана документація

- [Конфігурація](configuration.md) - Конфігурація контролю доступу
- [Архітектура](architecture.md) - Middleware контролю доступу
- [Усунення проблем](troubleshooting.md) - Загальні проблеми
